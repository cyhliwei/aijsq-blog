<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
  <head th:fragment="head(title, links, scripts)">
    <title
      th:replace="${title}"
      th:text="${global.siteInfo == null ? '' : global.siteInfo.websiteName}"
    >
      AI技术圈
    </title>
    <meta name="baidu-site-verification" content="codeva-mbGuu7l4Q1" />
    <meta
      name="keywords"
      content="AI技术圈,ai学习路径与课程、Prompts-提示词、Ai-网站和企业专栏、AI-工作流 、AI-研究报告、Ai-具身智能、AI-绘画、AI-视频、AI-Agents(智能体)、AI-数字人"
      th:if="${global.ogp == null}"
    />
    <meta name="description"
          th:if="${global.ogp == null}"
          content="AI技术圈，ai学习路径与课程、Prompts-提示词、Ai-网站和企业专栏、AI-工作流 、AI-研究报告、Ai-具身智能、AI-绘画、AI-视频、AI-Agents(智能体)、AI-数字人、辅助学习工具和资源、AI-语音合成、AI-音乐、AI-编程。"
    />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
    <meta name="robots" content="all">
    <meta name="mobile-web-app-capable" content="yes">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta th:each="tag: ${global.ogp}" th:attr="content=${tag.val}" th:property="${tag.key}"/>

    <script type="application/ld+json" th:utext="${global.jsonLd}"></script>

    <link rel="icon" href="/img/icon.png" th:href="${global.siteInfo.oss + '/img/icon.png'}"/>
    <link href="/css/three/index.css" th:href="@{{oss}/css/three/index.css(oss=${global.siteInfo.oss})}" rel="stylesheet" />
    <link href="/css/three/highlightjs.github.min.css" th:href="${global.siteInfo.oss + '/css/three/highlightjs.github.min.css'}" rel="stylesheet" />
    <link href="/css/three/nprogress.css" th:href="${global.siteInfo.oss + '/css/three/nprogress.css'}" rel="stylesheet" />
    <link href="/css/global.css" th:href="${global.siteInfo.oss + '/css/global.css'}" rel="stylesheet" />
    <link href="/css/common.css" th:href="${global.siteInfo.oss + '/css/common.css'}" rel="stylesheet" />
    <link href="/katex/katex.css" th:href="${global.siteInfo.oss + '/katex/katex.css'}" rel="stylesheet" >
    <link href="/admonition/admonition.css" th:href="${global.siteInfo.oss + '/admonition/admonition.css'}" rel="stylesheet" >
    <link href="/css/three/sweetalert2.min.css" th:href="${global.siteInfo.oss + '/css/three/sweetalert2.min.css'}" rel="stylesheet" />
    <link href="/css/three/fancybox.css" th:href="${global.siteInfo.oss + '/css/three/fancybox.css'}" rel="stylesheet" />
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?2745ad927051c4bc7b7ee34b781df793";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>

    <script src="/js/jquery.min.js" th:src="${global.siteInfo.oss + '/js/jquery.min.js'}"></script>
    <script src="/js/popper.min.js" th:src="${global.siteInfo.oss + '/js/popper.min.js'}"></script>
    <script src="/js/bootstrap.min.js" th:src="${global.siteInfo.oss + '/js/bootstrap.min.js'}"></script>
    <script src="/js/toastr.min.js" th:src="${global.siteInfo.oss + '/js/toastr.min.js'}"></script>
    <script src="/js/jquery.scrollUp.min.js" th:src="${global.siteInfo.oss + '/js/jquery.scrollUp.min.js'}"></script>
    <script src="/js/md5.min.js" th:src="${global.siteInfo.oss + '/js/md5.min.js'}"></script>
    <script src="/js/marked.min.js" th:src="${global.siteInfo.oss + '/js/marked.min.js'}"></script>
    <script src="/js/select2.full.min.js" th:src="${global.siteInfo.oss + '/js/select2.full.min.js'}"></script>
    <script src="/js/showdown.js" th:src="${global.siteInfo.oss + '/js/showdown.js'}" defer></script>
    <script src="/js/jsonld.min.js" th:src="${global.siteInfo.oss + '/js/jsonld.min.js'}"></script>
    <script src="/js/clipboard.min.js" th:src="${global.siteInfo.oss + '/js/clipboard.min.js'}"></script>
    <script src="/js/highlight.min.js" th:src="${global.siteInfo.oss + '/js/highlight.min.js'}"></script>
    <script src="/js/nprogress.js" th:src="${global.siteInfo.oss + '/js/nprogress.js'}"></script>
    <script defer src="/katex/katex.js" th:src="${global.siteInfo.oss + '/katex/katex.js'}"></script>
    <script defer src="/katex/contrib/auto-render.js" th:src="${global.siteInfo.oss + '/katex/contrib/auto-render.js'}"></script>
    <script src="/admonition/admonition.js" th:src="${global.siteInfo.oss + '/admonition/admonition.js'}"></script>
    <script src="/js/biz/forum.js" th:src="${global.siteInfo.oss + '/js/biz/forum.js'}"></script>
    <script src="/js/biz/loadMore.js" th:src="${global.siteInfo.oss + '/js/biz/loadMore.js'}"></script>
    <script src="/js/biz/toolaction.js" th:src="${global.siteInfo.oss + '/js/biz/toolaction.js'}"></script>
    <script src="/js/biz/login.js" th:src="${global.siteInfo.oss + '/js/biz/login.js'}"></script>
    <script src="/js/biz/select2.zh_CN.js" th:src="${global.siteInfo.oss + '/js/biz/select2.zh_CN.js'}"></script>
    <script src="/js/mathjax-config.js" th:src="${global.siteInfo.oss + '/js/mathjax-config.js'}" defer></script>
    <script src="/js/sweetalert2.min.js" th:src="${global.siteInfo.oss + '/js/sweetalert2.min.js'}"></script>
    <script src="/js/fancybox.umd.js" th:src="${global.siteInfo.oss + '/js/fancybox.umd.js'}"></script>
    <!-- 图片自适应宽度脚本 -->
    <script src="/js/biz/image-adaptive.js" th:src="${global.siteInfo.oss + '/js/biz/image-adaptive.js'}"></script>
    <script>
      // 图片域名替换监控器
      (function() {
        const targetDomain = 'cdn.tobebetterjavaer.com';
        const replacementDomain = 'cdn.aijsq.com';

        // 替换图片 URL 的函数
        function replaceImageUrl(url) {
          if (url && url.includes(targetDomain)) {
            return url.replace(targetDomain, replacementDomain);
          }
          return url;
        }

        // 检查并替换单个图片
        function checkAndReplaceImage(img) {
          if (img.src && img.src.includes(targetDomain)) {
            img.src = replaceImageUrl(img.src);
          }
        }

        // 替换页面中现有的图片
        function replaceExistingImages() {
          const images = document.querySelectorAll('img[src*="' + targetDomain + '"]');
          images.forEach(checkAndReplaceImage);
        }

        // 监听图片加载错误事件
        document.addEventListener('error', function(e) {
          if (e.target.tagName === 'IMG' && e.target.src.includes(targetDomain)) {
            console.log('Image load error:', e.target.src);
            e.target.src = replaceImageUrl(e.target.src);
          }
        }, true);

        // 使用 MutationObserver 监控动态添加的图片
        function setupDynamicMonitoring() {
          const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
              mutation.addedNodes.forEach(function(node) {
                if (node.nodeType === 1) { // Element node
                  if (node.tagName === 'IMG') {
                    checkAndReplaceImage(node);
                  }
                  // 检查新增节点中的图片
                  const images = node.querySelectorAll && node.querySelectorAll('img[src*="' + targetDomain + '"]');
                  if (images) {
                    images.forEach(checkAndReplaceImage);
                  }
                }
              });
            });
          });

          observer.observe(document.body, {
            childList: true,
            subtree: true
          });
        }

        // 页面加载完成后执行替换
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', function() {
            replaceExistingImages();
            setupDynamicMonitoring();
          });
        } else {
          replaceExistingImages();
          setupDynamicMonitoring();
        }
      })();
    </script>

    <th:block th:replace="${links}" />
    <th:block th:replace="${scripts}" />
  </head>
</html>
